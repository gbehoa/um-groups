var UM_wall_autocomplete_start,UM_wall_img_upload;function UM_wall_confirmbox_show(e,t,o){jQuery(".um-groups-confirm").is(":visible")||(jQuery(".um-groups-confirm-m").html(t),jQuery(".um-groups-confirm-o,.um-groups-confirm").show(),jQuery(".um-groups-confirm").find(".um-groups-confirm-btn").addClass(o).attr("data-post_id",e))}function UM_wall_confirmbox_hide(){jQuery(".um-groups-confirm-o,.um-groups-confirm").hide()}function UM_wall_confirmbox_mobile(){var e=jQuery(window).width();left=e<=500?(max_width=e,margin_left=0):(max_width="400px",margin_left="-200px","50%"),jQuery(".um-groups-confirm").css({top:(jQuery(window).height()-jQuery(".um-groups-confirm").height())/2+"px",width:max_width,"margin-left":margin_left,left:left})}function getUrlParameter(e){for(var t,o=decodeURIComponent(window.location.search.substring(1)).split("&"),r=0;r<o.length;r++)if((t=o[r].split("="))[0]===e)return void 0===t[1]||t[1]}function split(e){return e.split(" ")}function extractLast(e){return split(e).pop()}"object"!=typeof window.UM&&(window.UM={}),window.UM.groups={data:{group_id:null},getGroupID:function(){return jQuery('input[name="_group_id"]').length?UM.groups.data.group_id=jQuery('input[name="_group_id"]').val():jQuery('input[name="group_id"]').length?UM.groups.data.group_id=jQuery('input[name="group_id"]').val():jQuery("div[data-group_id]").length&&(UM.groups.data.group_id=jQuery("div[data-group_id]").attr("data-group_id")),UM.groups.data.group_id},postComment:function(r){var t,u,e,o,n,i,a;r.prop("disabled")||(t=r.data("commentid"),u=r.val(),e=r.parents(".um-groups-widget").attr("id").replace("postid-",""),o=jQuery("#commentid-"+t),t&&o.length&&o.hasClass("editing")?jQuery.ajax({url:wp.ajax.settings.url,type:"post",dataType:"json",data:{action:"um_groups_wall_comment",postid:e,commentid:t,comment:u,group_id:UM.groups.getGroupID(),nonce:um_scripts.nonce},beforeSend:function(){r.prop("disabled",!0).addClass("um-disabled")},success:function(e){r.prop("disabled",!1).removeClass("um-disabled"),o.find("#um-groups-reply-"+t).val(u),o.find(".um-groups-comment-text").html(e.comment_content),o.find(".um-groups-editc-d").hide(),o.find(".um-groups-comment-area").remove(),o.find(".um-groups-comment-info > div").show(),o.removeClass("editing"),o.find(".um-groups-commentl.um-groups-comment-area").show(),void 0!==e.restricted&&(alert(e.restricted),window.location.reload()),void 0!==e.debug&&console.log(e.debug)}}):(n=r.parents(".um-groups-comments"),i=r.attr("data-reply_to"),n.find(".um-groups-comment-post").addClass("um-disabled"),n.find(".um-groups-commentload").remove(),n.find(".um-groups-commentload-spin").remove(),(a=r.parents(".um-groups-widget").find(".um-groups-post-comments")).html(parseInt(a.html())+1),n.find(".um-groups-commentload").appendTo(n.find(".um-groups-comments-loop")),n.find(".um-groups-commentload-spin").appendTo(n.find(".um-groups-comments-loop")),jQuery.ajax({url:wp.ajax.settings.url,type:"post",dataType:"json",data:{action:"um_groups_wall_comment",postid:e,reply_to:i,comment:u,group_id:UM.groups.getGroupID(),nonce:um_scripts.nonce},beforeSend:function(){r.prop("disabled",!0).addClass("um-disabled")},success:function(e){r.prop("disabled",!1).removeClass("um-disabled");var t,o=(0<i?n.find(".um-groups-commentlre-clone:first"):n.find(".um-groups-commentl-clone:first")).clone();o.attr("id","commentid-"+e.commentid).removeClass("um-groups-commentl-clone um-groups-commentlre-clone"),o.find(".original-content").attr("id","um-groups-reply-"+e.commentid).val(u),o.find(".um-groups-editc-d .edit").data("commentid",e.commentid),o.find(".um-groups-comment-reply").attr("data-commentid",e.commentid),o.find(".um-groups-comment-text").html(e.comment_content),0<i?(0===(t=r.closest(".um-groups-commentwrap")).find(".um-groups-comment-child").length&&t.append('<div class="um-groups-comment-child"></div>'),o.appendTo(t.find(".um-groups-comment-child")),r.closest(".um-groups-comment-area").remove()):((t=n.find(".um-groups-commentwrap-clone").clone().removeClass("um-groups-commentwrap-clone").addClass("um-groups-commentwrap").attr("data-comment_id",e.commentid)).find(".um-groups-comment-child").remove(),t.appendTo(n.find(".um-groups-comments-loop")),o.appendTo(t),r.val("")),jQuery(".um-groups-commentl.highlighted").removeClass("highlighted"),o.addClass("highlighted").removeClass("unready").fadeTo(1e3,1),UM.groups.scrollTo(o),void 0!==e.restricted&&(alert(e.restricted),window.location.reload()),void 0!==e.debug&&console.log(e.debug)}})))},scrollTo:function(e,t){e=jQuery(e);return e.length&&(t="object"==typeof t?jQuery.extend({offset:-32},t):{offset:-32},jQuery("body").scrollTo(e,500,t),jQuery(".um-groups-wall .highlighted").removeClass("highlighted"),e.addClass("highlighted")),e},wallAutocompleteStart:function(){jQuery("textarea.um-groups-textarea-elem,textarea.um-groups-comment-textarea").each(function(e,t){if(el=jQuery(t),void 0===jQuery.ui)return!1;el.autocomplete({minLength:1,source:function(e,t){"@"==extractLast(e.term).charAt(0)&&jQuery.getJSON(wp.ajax.settings.url+"?action=um_groups_get_user_suggestions&term="+extractLast(e.term)+"&group_id="+jQuery("#_group_id").val()+"&nonce="+um_scripts.nonce,function(e){console.log(e),t(e)})},select:function(e,t){t.item.name=t.item.name.replace("<strong>",""),t.item.name=t.item.name.replace("</strong>","");var o=split(this.value);return o.pop(),o.push("@"+t.item.name),o.push(""),this.value=jQuery.trim(o.join(" ")),!1}}).data("ui-autocomplete")._renderItem=function(e,t){return jQuery("<li />").data("item.autocomplete",t).append(t.photo+t.name+"<span>@"+t.username+"</span>").appendTo(e)}})},wallImgUpload:function(){var u;jQuery(".ajax-upload-dragdrop").remove(),jQuery(".um-groups-insert-photo").each(function(e,t){var r=jQuery(t),t=(u=r.parents(".um-groups-widget"),{key:"wall_img_upload",action:"um_imageupload",set_id:0,set_mode:"wall",timestamp:r.data("timestamp"),_wpnonce:r.data("nonce"),group_id:UM.groups.getGroupID()}),t={url:wp.ajax.settings.url,method:"POST",multiple:!1,formData:t,fileName:"wall_img_upload",allowedTypes:r.attr("data-allowed"),maxFileSize:um_scripts.max_upload_size||10485760,dragDropStr:"",sizeErrorStr:r.attr("data-size-err"),extErrorStr:r.attr("data-ext-err"),maxFileCountErrorStr:"",maxFileCount:1,showDelete:!1,showAbort:!1,showDone:!1,showFileCounter:!1,showStatusAfterSuccess:!0,returnType:"json",onSubmit:function(e){u.find(".um-error-block").remove(),u.find(".um-groups-post").addClass("um-disabled"),u.find(".um-groups-preview").hide(),u.find(".um-groups-preview img").attr("src",""),u.find('.um-groups-preview input[type="hidden"]').val("")},onSuccess:function(e,t,o){r.selectedFiles=0,t.status&&!1===t.status?(u.find(".um-groups-post").addClass("um-disabled"),u.find(".um-groups-textarea-elem").attr("placeholder",jQuery(".um-groups-textarea-elem").attr("data-ph")),u.find(".upload-statusbar").prev("div").append('<div class="um-error-block">'+t.error+"</div>"),u.find(".upload-statusbar").remove()):"object"==typeof t.data&&void 0!==t.data.error?(u.find(".um-groups-post").addClass("um-disabled"),u.find(".upload-statusbar").prev("div").append('<div class="um-error-block">'+t.data.error+"</div>"),u.find(".upload-statusbar").remove()):(u.find(".um-groups-post").removeClass("um-disabled"),u.find(".um-groups-textarea-elem").attr("placeholder",jQuery(".um-groups-textarea-elem").attr("data-photoph")),u.find(".upload-statusbar").remove(),jQuery.each(t.data,function(e,t){u.find(".um-groups-preview").show(),u.find(".um-groups-preview img").attr("src",t.url),u.find('.um-groups-preview input[type="hidden"][name="_post_img"]').val(t.file),u.find('.um-groups-preview input[type="hidden"][name="_post_img_url"]').val(t.url)}))},onError:function(e){console.log(e)}};r.uploadFile(wp.hooks.applyFilters("um_group_img_uploader_param",t,r))})}},Loadwall_ajax=!1,void 0===UM_wall_autocomplete_start&&(UM_wall_autocomplete_start=UM.groups.wallAutocompleteStart),void 0===UM_wall_img_upload&&(UM_wall_img_upload=UM.groups.wallImgUpload),jQuery(window).on("resize",function(){UM_wall_confirmbox_mobile()}),jQuery(window).on("scroll",function(){0<jQuery(".um-groups-wall").length&&jQuery(window).scrollTop()+jQuery(window).height()>=jQuery(".um-groups-wall").offset().top+jQuery(".um-groups-wall").height()&&0==Loadwall_ajax&&0==jQuery(".um-groups-wall").attr("data-single_post")&&(Loadwall_ajax=!0,jQuery(".um-groups-load:last").show(),group_id=jQuery(".um-groups-wall").attr("data-group_id")||UM.groups.getGroupID(),core_page=jQuery(".um-groups-wall").attr("data-core_page"),hashtag=jQuery(".um-groups-wall").attr("data-hashtag"),user_id=jQuery(".um-groups-wall").attr("data-user_id"),user_wall=jQuery(".um-groups-wall").attr("data-user_wall"),show_pending=jQuery(".um-groups-wall").attr("data-show-pending"),jQuery.ajax({url:wp.ajax.settings.url,type:"post",data:{action:"um_groups_load_wall",offset:jQuery(".um-groups-widget:not(.um-groups-new-post):visible").length,user_id:user_id,user_wall:user_wall,hashtag:hashtag,core_page:core_page,group_id:group_id,show_pending:show_pending,nonce:um_scripts.nonce},success:function(e){jQuery(".um-groups-load").hide(),Loadwall_ajax=""==e||(jQuery(".um-groups-wall").append(e),!1),void 0!==e.restricted&&(alert(e.restricted),window.location.reload()),void 0!==e.debug&&console.log(e.debug)},error:function(e){console.log("UM Groups Discussion Error",e)}}))}),jQuery(document).ready(function(){jQuery("textarea.um-groups-textarea-elem").length&&UM.groups.wallAutocompleteStart();var e=getUrlParameter("group_post"),t=getUrlParameter("wall_comment_id");0<e&&!t&&jQuery("body").scrollTo("#postid-"+parseInt(e),500,{offset:0,onAfter:function(){jQuery("#postid-"+parseInt(e)).addClass("highlighted")}}),0<e&&0<t&&jQuery("body").scrollTo("#commentid-"+parseInt(t),500,{offset:-10,onAfter:function(){jQuery("#commentid-"+parseInt(t)).addClass("highlighted")}}),location.hash&&setTimeout(function(){UM.groups.scrollTo(location.hash)},400),jQuery(document).on("click",".um-groups-disp-comments",function(e){e.preventDefault();e=jQuery(this).parents(".um-groups-widget").attr("id").replace("postid-","");return jQuery("body").scrollTo("#wallcomments-"+parseInt(e),{duration:200}),!1}),jQuery(document).on("click",".um-groups-confirm-removepost",function(e){e.preventDefault();e=jQuery(this).attr("data-post_id");return jQuery(".um-groups-widget#postid-"+e).hide(),UM_wall_confirmbox_hide(),jQuery.ajax({url:wp.ajax.settings.url,type:"post",data:{action:"um_groups_remove_post",post_id:e,group_id:UM.groups.getGroupID(),nonce:um_scripts.nonce},success:function(e){void 0!==e.restricted&&(alert(e.restricted),window.location.reload()),void 0!==e.debug&&console.log(e.debug)}}),!1}),jQuery(document).on("click",".um-groups-confirm-removecomment",function(e){e.preventDefault();e=jQuery(this).attr("data-post_id");return jQuery(".um-groups-commentl#commentid-"+e).hide(),UM_wall_confirmbox_hide(),jQuery.ajax({url:wp.ajax.settings.url,type:"post",data:{action:"um_groups_remove_comment",comment_id:e,group_id:UM.groups.getGroupID(),nonce:um_scripts.nonce},success:function(e){void 0!==e.restricted&&(alert(e.restricted),window.location.reload()),void 0!==e.debug&&console.log(e.debug)}}),!1}),jQuery(document).on("click",".um-groups-trash",function(e){e.preventDefault();var e=jQuery(this),t=e.parents(".um-groups-widget").attr("id").replace("postid-",""),o=e.attr("data-msg");return e.parents(".um-groups-dialog").hide(),UM_wall_confirmbox_show(t,o,"um-groups-confirm-removepost"),UM_wall_confirmbox_mobile(),!1}),jQuery(document).on("click",".um-groups-editc a.delete",function(e){e.preventDefault();var e=jQuery(this),t=e.parent().parent().parent().parent().parent().attr("id").replace("commentid-",""),o=e.attr("data-msg");return e.parents(".um-groups-dialog").hide(),UM_wall_confirmbox_show(t,o,"um-groups-confirm-removecomment"),UM_wall_confirmbox_mobile(),!1}),jQuery(document).on("click",".um-groups-confirm-close,.um-groups-confirm-o",function(e){return e.preventDefault(),UM_wall_confirmbox_hide(),!1}),jQuery(document).on("click",".um-groups-modal-hide",function(e){return e.preventDefault(),remove_Modal(),!1}),jQuery(document).on("click",".um-groups-img-remove",function(e){(el=jQuery(this).parents("form")).find("#_post_img").val(""),el.find(".um-groups-preview img").attr("src",""),el.find(".um-groups-preview").hide(),0==el.find("textarea:visible").val().trim().length&&el.find(".um-groups-post").addClass("um-disabled")}),UM.groups.wallImgUpload(),jQuery(document).on("click",".um-groups-comment-hide",function(e){return e.preventDefault(),el=jQuery(this),(div=el.parent()).hasClass("editing")?(div.find(".um-groups-comment-area").remove(),div.find(".um-groups-comment-info > div").show(),div.find(".um-groups-editc-d").hide(),div.removeClass("editing")):(e=div.attr("id").replace("commentid-",""),div.find(".um-groups-comment-info").hide(),div.find(".um-groups-comment-hidden").show(),div.find(".um-groups-comment-avatar").addClass("hidden-1"),el.remove(),jQuery.ajax({url:wp.ajax.settings.url,type:"post",data:{action:"um_groups_hide_comment",comment_id:e,group_id:UM.groups.getGroupID(),nonce:um_scripts.nonce},success:function(e){void 0!==e.restricted&&(alert(e.restricted),window.location.reload()),void 0!==e.debug&&console.log(e.debug)}})),!1}),jQuery(document).on("click",".um-groups-comment-hidden a",function(e){e.preventDefault();e=(el=jQuery(this)).parent().parent().attr("id").replace("commentid-","");return el.parent().parent().find(".um-groups-comment-info").show(),el.parent().parent().find(".um-groups-comment-hidden").hide(),el.parent().parent().find(".um-groups-comment-hide").show(),el.parent().parent().find(".um-groups-comment-avatar").removeClass("hidden-1"),el.parent().parent().prepend('<a href="#" class="um-groups-comment-hide um-tip-s"><i class="um-icon-close-round"></i></a>'),jQuery.ajax({url:wp.ajax.settings.url,type:"post",data:{action:"um_groups_unhide_comment",comment_id:e,group_id:UM.groups.getGroupID(),nonce:um_scripts.nonce},success:function(e){void 0!==e.restricted&&(alert(e.restricted),window.location.reload()),void 0!==e.debug&&console.log(e.debug)}}),!1}),jQuery(document).on("click",".um-groups-show-likes",function(e){e.preventDefault();e=(el=jQuery(this)).attr("data-post_id");return parseInt(el.find(".um-groups-post-likes").html())<=0||(prepare_Modal(),jQuery.ajax({url:wp.ajax.settings.url,type:"post",data:{action:"um_groups_get_post_likes",post_id:e,group_id:UM.groups.getGroupID(),nonce:um_scripts.nonce},success:function(e){(e?(show_Modal(e),responsive_Modal):remove_Modal)(),void 0!==e.restricted&&(alert(e.restricted),window.location.reload()),void 0!==e.debug&&console.log(e.debug)}})),!1}),jQuery(document).on("click",".um-groups-comment-likes",function(e){e.preventDefault();e=(el=jQuery(this)).parent().parent().parent().attr("id").replace("commentid-","");return prepare_Modal(),jQuery.ajax({url:wp.ajax.settings.url,type:"post",data:{action:"um_groups_get_comment_likes",comment_id:e,group_id:UM.groups.getGroupID(),nonce:um_scripts.nonce},success:function(e){(e?(show_Modal(e),responsive_Modal):remove_Modal)(),void 0!==e.restricted&&(alert(e.restricted),window.location.reload()),void 0!==e.debug&&console.log(e.debug)}}),!1}),jQuery(document).on("mouseover",".um-groups-commentl",function(e){jQuery(this).find(".um-groups-comment-hide").show()}),jQuery(document).on("mouseout",".um-groups-commentl",function(e){jQuery(this).find(".um-groups-comment-hide").hide()}),jQuery(document).on("click",".um-groups-report:not(.flagged)",function(e){var t=jQuery(this),o=t.parents(".um-groups-widget").attr("id").replace("postid-","");jQuery.ajax({url:wp.ajax.settings.url,type:"post",data:{action:"um_groups_report_post",post_id:o,group_id:UM.groups.getGroupID(),nonce:um_scripts.nonce},success:function(e){t.addClass("flagged").html(t.attr("data-cancel_report")),void 0!==e.restricted&&(alert(e.restricted),window.location.reload()),void 0!==e.debug&&console.log(e.debug)}})}),jQuery(document).on("click",".um-groups-report.flagged",function(e){var t=jQuery(this),o=t.parents(".um-groups-widget").attr("id").replace("postid-","");jQuery.ajax({url:wp.ajax.settings.url,type:"post",data:{action:"um_groups_unreport_post",post_id:o,group_id:UM.groups.getGroupID(),nonce:um_scripts.nonce},success:function(e){t.removeClass("flagged").html(t.attr("data-report")),void 0!==e.restricted&&(alert(e.restricted),window.location.reload()),void 0!==e.debug&&console.log(e.debug)}})}),jQuery(document).on("click",".um-groups-commentload",function(e){e.preventDefault();var t=jQuery(this),e=(t.hide(),t.parent().find(".um-groups-commentload-spin").show(),t.attr("data-loaded")),o=t.parents(".um-groups-widget").attr("id").replace("postid-","");return t.parents(".um-groups-comments").find(".um-groups-commentload-end").remove(),jQuery.ajax({url:wp.ajax.settings.url,type:"post",data:{action:"um_groups_load_more_comments",post_id:o,offset:e,group_id:UM.groups.getGroupID(),nonce:um_scripts.nonce},success:function(e){t.before(e),t.attr("data-loaded",t.parents(".um-groups-comments").find(".um-groups-commentl:not(.is-child):not(.um-groups-comment-area):visible").length),t.parent().find(".um-groups-commentload-spin").hide(),t.parents(".um-groups-comments").find(".um-groups-commentload-end").length&&t.show().find("span").html(t.attr("data-load_comments")),void 0!==e.restricted&&(alert(e.restricted),window.location.reload()),void 0!==e.debug&&console.log(e.debug)}}),!1}),jQuery(document).on("click",".um-groups-ccommentload",function(e){e.preventDefault();var t=jQuery(this),e=(t.hide(),t.parent().find(".um-groups-ccommentload-spin").show(),t.attr("data-loaded")),o=t.parents(".um-groups-widget").attr("id").replace("postid-",""),r=t.parents(".um-groups-commentwrap").attr("data-comment_id");return t.parents(".um-groups-comments").find(".um-groups-ccommentload-end").remove(),jQuery.ajax({url:wp.ajax.settings.url,type:"post",data:{action:"um_groups_load_more_replies",post_id:o,comment_id:r,offset:e,group_id:UM.groups.getGroupID(),nonce:um_scripts.nonce},success:function(e){t.before(e),t.attr("data-loaded",t.parents(".um-groups-commentwrap").find(".um-groups-commentl.is-child:not(.um-groups-comment-area):visible").length),t.parent().find(".um-groups-ccommentload-spin").hide(),t.parents(".um-groups-commentwrap").find(".um-groups-ccommentload-end").length&&t.show().find("span").html(t.attr("data-load_replies")),void 0!==e.restricted&&(alert(e.restricted),window.location.reload()),void 0!==e.debug&&console.log(e.debug)}}),!1}),jQuery(document).on("click",".um-groups-post",function(e){return e.preventDefault(),jQuery(this).hasClass("um-disabled")||jQuery(this).parents(".um-groups-widget").find(".um-groups-publish").trigger("submit"),!1}),jQuery(document).on("input properychange",".um-groups-textarea-elem",function(){0<jQuery(this).val().trim().length?jQuery(this).parents(".um-groups-widget").find(".um-groups-post").removeClass("um-disabled"):jQuery(this).parents(".um-groups-widget").find(".um-groups-post").addClass("um-disabled")}),jQuery(document).on("input properychange",".um-groups-comment-textarea",function(e){0<jQuery(e.currentTarget).val().trim().length?jQuery(e.currentTarget).closest(".um-groups-comment-area").find(".um-groups-comment-post").removeClass("um-disabled"):jQuery(e.currentTarget).closest(".um-groups-comment-area").find(".um-groups-comment-post").addClass("um-disabled")}),jQuery(document).on("click",".um-groups-comment-reply",function(e){if(e.preventDefault(),jQuery(this).parents(".um-groups-commentl").hasClass("unready"))return!1;0==jQuery(this).parents(".um-groups-comment-info").find(".um-groups-comment-area").length?((e=jQuery(this).parents(".um-groups-comments").find(".um-groups-comment-area:first").clone()).appendTo(jQuery(this).parents(".um-groups-comment-info")),e.find("textarea").attr("data-reply_to",jQuery(this).attr("data-commentid")).attr("placeholder",e.find("textarea").attr("data-replytext")).trigger("focus"),UM.groups.wallAutocompleteStart()):jQuery(this).parents(".um-groups-comment-info").find(".um-groups-comment-area").remove()}),jQuery(document).on("click",".um-groups-editc a.edit",function(e){e.preventDefault();var t=jQuery(e.currentTarget),o=t.closest(".um-groups-comment-info");if(t.parents(".um-groups-commentl").hasClass("unready"))return!1;0<o.find(".um-groups-comment-area").length&&o.find(".um-groups-comment-area").remove();var r=t.data("commentid"),u=jQuery("#commentid-"+r).addClass("editing"),n={comment:jQuery("#um-groups-reply-"+r).val(),comment_id:r,reply_to:u.hasClass("is-child")?t.parents(".um-groups-commentwrap").data("comment_id"):0};try{var i=wp.template("um-groups-comment-edit")(n)}catch(e){var a,i=jQuery("#tmpl-um-groups-comment-edit").unwrap().html();for(a in n)i=i.replace("{{{data."+a+"}}}",n[a])}o.find("div").hide(),o.find(".um-groups-editc-d").hide(),o.append(i).find("textarea").trigger("focus"),UM.groups.wallAutocompleteStart()}),jQuery(document).on("click",".um-groups-comment-edit-cancel",function(e){e.preventDefault();var e=jQuery(e.currentTarget),t=e.closest(".um-groups-comment-info");t.find(".um-groups-comment-data").show(),t.find(".um-groups-comment-meta").show(),t.parent().removeClass("editing"),e.closest(".um-groups-commentl.um-groups-comment-area").remove()}),jQuery(document).on("keypress",".um-groups-comment-textarea",function(e){10!=e.keyCode&&13!=e.keyCode||e.shiftKey||(e.preventDefault(),0<jQuery(e.currentTarget).val().trim().length&&UM.groups.postComment(jQuery(e.currentTarget)))}).on("click",".um-groups-comment-post:not(.um-disabled)",function(e){e.preventDefault();e=jQuery(e.currentTarget).closest(".um-groups-comment-area").find(".um-groups-comment-textarea:visible").last();UM.groups.postComment(e)}),jQuery(document).on("click",".um-groups-dialog a",function(e){return e.preventDefault(),e.stopPropagation(),!1}),jQuery(document).on("click",".um-groups-start-dialog",function(e){return e.stopPropagation(),e.preventDefault(),jQuery(this).parents(".um-groups-widget").hasClass("unready")||((e=jQuery(this).parent().find("."+jQuery(this).attr("data-role"))).is(":visible")?e.hide():e.show()),!1}),jQuery(document).on("click",".um-groups-editc a",function(e){e.stopPropagation(),e.preventDefault(),jQuery(".um-groups-comment-meta").find(".um-groups-editc-d:visible").hide();e=jQuery(this).parents(".um-groups-comment-meta").find(".um-groups-editc-d");return e.is(":visible")?e.hide():e.show(),!1}),jQuery(document).on("click",function(){jQuery(".um-groups-dialog").hide(),jQuery(".um-groups-comment-meta").find(".um-groups-editc-d:visible").hide()}),jQuery(document).on("click",".um-groups-comment a",function(e){return e.preventDefault(),jQuery(this).parents(".um-groups-widget").hasClass("unready")||jQuery(this).parents(".um-groups-widget").find(".um-groups-comments .um-groups-comment-box textarea").trigger("focus"),!1}),jQuery(document).on("click",".um-groups-comment-like:not(.active)",function(e){var t,o,r,u;return e.preventDefault(),jQuery(this).parents(".um-groups-commentl").hasClass("unready")||(e=jQuery(e.currentTarget),o=(t=e.parents(".um-groups-commentl")).attr("id").replace("commentid-",""),r=t.find(".um-groups-ajaxdata-commentlikes"),u=e.addClass("active").attr("data-unlike_text"),e.html(u),jQuery.ajax({url:wp.ajax.settings.url,type:"post",dataType:"json",data:{action:"um_groups_like_comment",commentid:o,group_id:UM.groups.getGroupID(),nonce:um_scripts.nonce},success:function(e){void 0!==e.likes_count&&(r.html(e.likes_count),t.find(".um-groups-comment-likes").removeClass("count-0").addClass("count-"+e.likes_count)),void 0!==e.restricted&&(alert(e.restricted),window.location.reload()),void 0!==e.debug&&console.log(e.debug)}})),!1}),jQuery(document).on("click",".um-groups-comment-like.active",function(e){e.preventDefault();var e=jQuery(e.currentTarget),t=e.parents(".um-groups-commentl"),o=t.attr("id").replace("commentid-",""),r=t.find(".um-groups-ajaxdata-commentlikes"),u=e.removeClass("active").attr("data-like_text");return e.html(u),jQuery.ajax({url:wp.ajax.settings.url,type:"post",dataType:"json",data:{action:"um_groups_unlike_comment",commentid:o,group_id:UM.groups.getGroupID(),nonce:um_scripts.nonce},success:function(e){void 0!==e.likes_count&&(r.html(e.likes_count),t.find(".um-groups-comment-likes").removeClass("count-0").addClass("count-"+e.likes_count)),void 0!==e.restricted&&(alert(e.restricted),window.location.reload()),void 0!==e.debug&&console.log(e.debug)}}),!1}),jQuery(document).on("click",".um-groups-like:not(.active) a",function(e){e.preventDefault();var t,o,r,u,e=jQuery(e.currentTarget);return e.parents(".um-groups-widget").hasClass("unready")||(t=e.closest(".um-groups-widget"),o=t.find(".um-groups-post-likes"),r=t.attr("id").replace("postid-",""),u=e.parent().addClass("active").attr("data-unlike_text"),e.find("i").addClass(" um-active-color um-effect-pop"),e.find("span").html(u),jQuery.ajax({url:wp.ajax.settings.url,type:"post",dataType:"json",data:{action:"um_groups_like_post",postid:r,group_id:UM.groups.getGroupID(),nonce:um_scripts.nonce},success:function(e){void 0!==e.counters_html?(t.find(".um-groups-disp").remove(),t.find(".um-groups-body").append(e.counters_html)):void 0!==e.likes_count&&o.length&&o.html(e.likes_count),void 0!==e.restricted&&(alert(e.restricted),window.location.reload()),void 0!==e.debug&&console.log(e.debug)}})),!1}),jQuery(document).on("click",".um-groups-like.active a",function(e){e.preventDefault();var e=jQuery(e.currentTarget),t=e.closest(".um-groups-widget"),o=t.find(".um-groups-post-likes"),r=t.attr("id").replace("postid-",""),u=e.parent().removeClass("active").attr("data-like_text");return e.find("i").removeClass(" um-active-color um-effect-pop"),e.find("span").html(u),jQuery.ajax({url:wp.ajax.settings.url,type:"post",dataType:"json",data:{action:"um_groups_unlike_post",postid:r,group_id:UM.groups.getGroupID(),nonce:um_scripts.nonce},success:function(e){void 0!==e.counters_html?(t.find(".um-groups-disp").remove(),t.find(".um-groups-body").append(e.counters_html)):void 0!==e.likes_count&&o.length&&o.html(e.likes_count),void 0!==e.restricted&&(alert(e.restricted),window.location.reload()),void 0!==e.debug&&console.log(e.debug)}}),!1}),jQuery(document).on("click",".um-groups-manage, .um-groups-edit-cancel",function(e){e.preventDefault();var t,o,r,e=jQuery(this),u=e.parents(".um-groups-widget").attr("id").replace("postid-","");return jQuery(this).parents(".um-groups-dialog").length&&jQuery(this).parents(".um-groups-dialog").hide(),0<e.parents(".um-groups-widget").find("form").length?(e.parents(".um-groups-widget").find(".um-groups-bodyinner-txt").show(),e.parents(".um-groups-widget").find(".um-groups-bodyinner-photo").show(),e.parents(".um-groups-widget").find(".um-groups-bodyinner-video").show(),e.parents(".um-groups-widget").find("form").remove()):((t=jQuery(".um-groups-new-post form").clone()).appendTo(e.parents(".um-groups-widget").find(".um-groups-bodyinner-edit")),t.find("textarea:visible").val(e.parents(".um-groups-widget").find(".um-groups-bodyinner-edit").find("textarea:hidden").val()).trigger("focus"),e.parents(".um-groups-widget").find(".um-groups-bodyinner-edit").find("#_photo_").val()&&(t.find(".um-groups-preview").show(),e.parents(".um-groups-widget").find(".um-groups-bodyinner-edit").find("#_photo_url").val()?(t.find(".um-groups-preview img").attr("src",e.parents(".um-groups-widget").find(".um-groups-bodyinner-edit").find("#_photo_url").val()),t.find(".um-groups-preview input[type=hidden]").val(e.parents(".um-groups-widget").find(".um-groups-bodyinner-edit").find("#_photo_url").val())):(t.find(".um-groups-preview img").attr("src",e.parents(".um-groups-widget").find(".um-groups-bodyinner-edit").find("#_photo_").val()),t.find(".um-groups-preview input[type=hidden]").val(e.parents(".um-groups-widget").find(".um-groups-bodyinner-edit").find("#_photo_").val())),o=e.parents(".um-groups-widget").find(".um-groups-bodyinner-edit").find("#_photo_").clone(),r=e.parents(".um-groups-widget").find(".um-groups-bodyinner-edit").find("#_photo_url").clone(),o.appendTo(e.parents(".um-groups-widget").find(".um-groups-bodyinner-edit")),r.appendTo(e.parents(".um-groups-widget").find(".um-groups-bodyinner-edit"))),t.find(".um-groups-post").html(e.attr("data-update_text")),t.find(".um-groups-post").before('<a href="#" class="um-groups-edit-cancel">'+e.attr("data-cancel_text")+"</a>"),t.find("#_post_id").val(u),e.parents(".um-groups-widget").find(".um-groups-bodyinner-txt").hide(),e.parents(".um-groups-widget").find(".um-groups-bodyinner-photo").hide(),e.parents(".um-groups-widget").find(".um-groups-bodyinner-video").hide(),UM.groups.wallImgUpload(),UM.groups.wallAutocompleteStart()),jQuery("textarea.um-groups-textarea-elem").autoResize(),!1}),jQuery(document).on("submit",".um-groups-publish",function(e){e.preventDefault();var t,o=jQuery(this);return 0==o.find("textarea").val().trim().length&&0==o.find("#_post_img").val().trim().length?o.find("textarea").trigger("focus"):(jQuery(".um-groups-post").addClass("um-disabled"),formdata=o.serialize(),formdata_array=function(e){for(var t={},o=0;o<e.length;o++)t[e[o].name]=e[o].value;return t}(o.serializeArray()),0==o.find("#_post_id").val()?(e=o.parents(".um").find(".um-groups-wall"),(t=e.find(".um-groups-clone:first").clone()).prependTo(e).addClass("unready").fadeIn().find(".um-groups-bodyinner-txt").text(o.find("textarea").val()),0<o.find("#_post_img").val().trim().length&&(0==t.find(".um-groups-bodyinner-txt").html().trim().length&&t.find(".um-groups-bodyinner-txt").hide(),t.prependTo(e).find(".um-groups-bodyinner-photo").html('<a href="#" class="um-photo-modal" data-src="'+o.find("#_post_img").val()+'"><img src="'+o.find("#_post_img_url").val()+'" alt="" /></a>')),o.find("textarea").val("").height("auto"),o.find("#_post_img").val(""),o.find(".um-groups-preview").hide(),jQuery(".um-groups-textarea-elem").attr("placeholder",jQuery(".um-groups-textarea-elem").attr("data-ph"))):o.css({opacity:.5}),jQuery.ajax({url:wp.ajax.settings.url,type:"post",dataType:"json",data:formdata,success:function(e){0==o.find("#_post_id").val()?(o.find(".um-groups-preview").find("img").attr("src",""),t.removeClass("unready").attr("id","postid-"+e.postid).removeClass("um-groups-clone"),t.find(".um-groups-comment-textarea").show(),e.orig_content?t.find(".um-groups-bodyinner-edit textarea").val(e.orig_content):t.find(".um-groups-bodyinner-edit textarea").val(""),e.content?t.find(".um-groups-bodyinner-txt").html(e.content):t.find(".um-groups-bodyinner-txt").empty().hide(),e.link&&(t.find(".um-groups-bodyinner-txt").find(".post-meta").length?t.find(".um-groups-bodyinner-txt").show().find(".post-meta").replaceWith(e.link):t.find(".um-groups-bodyinner-txt").show().append(e.link)),e.photo?(t.find(".um-groups-bodyinner-edit input#_photo_").val(e.photo_base),t.find(".um-groups-bodyinner-edit input#_photo_url").val(e.photo),t.find(".um-groups-bodyinner-photo").find("a").attr("data-src",e.photo),t.find(".um-groups-bodyinner-photo").find("a").attr("href",e.photo),t.find(".um-groups-bodyinner-photo").find("img").attr("src",e.photo)):t.find(".um-groups-bodyinner-edit input#_photo_").val(""),e.video&&t.find(".um-groups-bodyinner-video").html(e.video),t.find(".um-groups-metadata a").attr("href",e.permalink),jQuery(t.find(".um-groups-comment-textarea")).autoResize()):((elem=o.parents(".um-groups-widget")).find("form").remove(),e.orig_content?elem.find(".um-groups-bodyinner-edit textarea").val(e.orig_content):elem.find(".um-groups-bodyinner-edit textarea").val(""),e.content?(elem.find(".um-groups-bodyinner-txt").html(e.content),elem.find(".um-groups-bodyinner-txt").show()):elem.find(".um-groups-bodyinner-txt").empty().hide(),e.link&&(elem.find(".um-groups-bodyinner-txt").find(".post-meta").length?elem.find(".um-groups-bodyinner-txt").show().find(".post-meta").replaceWith(e.link):elem.find(".um-groups-bodyinner-txt").show().append(e.link)),e.photo?(elem.find(".um-groups-bodyinner-edit input#_photo_").val(e.photo_base),elem.find(".um-groups-bodyinner-edit input#_photo_url").val(e.photo),0==elem.find(".um-groups-bodyinner-photo").find("a").length?elem.find(".um-groups-bodyinner-photo").html('<a href="'+e.photo+'"><img src="'+e.photo+'" alt="" /></a>'):(elem.find(".um-groups-bodyinner-photo").find("a").attr("href",e.photo),elem.find(".um-groups-bodyinner-photo").find("img").attr("src",e.photo)),elem.find(".um-groups-bodyinner-photo").show()):(elem.find(".um-groups-bodyinner-edit input#_photo_").val(""),elem.find(".um-groups-bodyinner-photo").empty().hide()),e.video?(elem.find(".um-groups-bodyinner-video").html(e.video),elem.find(".um-groups-bodyinner-video").show()):elem.find(".um-groups-bodyinner-video").empty().hide()),UM.groups.wallAutocompleteStart()}})),!1}),jQuery(document).on("click",".um-groups-seemore a",function(e){return e.preventDefault(),(p=jQuery(this).parents(".um-groups-bodyinner-txt")).find(".um-groups-seemore").remove(),p.find(".um-groups-hiddentext").show(),!1}),jQuery(".um-groups-widget:not(.um-groups-clone) .um-groups-comment-textarea").autoResize(),jQuery(".um-groups-textarea-elem").autoResize(),jQuery(document).on("click",".um-groups-post-approval-tool",function(){var t=jQuery(this),e=jQuery(this).attr("data-role"),o=jQuery(this).attr("data-uid"),r=UM.groups.getGroupID(),u=jQuery(this).attr("data-discussion-id"),n=t.attr("data-msg");"delete"==action?(UM_wall_confirmbox_show(u,n,"um-groups-confirm-removepost"),UM_wall_confirmbox_mobile()):jQuery.ajax({method:"POST",url:wp.ajax.settings.url,type:"post",data:{role:e,action:"um_groups_approve_discussion_post",group_id:r,user_id:o,post_id:u,nonce:um_scripts.nonce}}).done(function(e){"deleted"!=e.status&&"approved"!=e.status||t.parents("div[class=um-groups-widget]").remove(),t.parents("div[class=um-groups-wall]").find("div[class=um-groups-widget]:not(.um-groups-clone)").length<=0&&jQuery("ul.um-groups-single-tabs li:first a").trigger("click")})}),jQuery("ul.um-groups-single-tabs li:first a").on("click",function(){window.location.href=jQuery(this).attr("href")})});