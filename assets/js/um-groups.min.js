var um_groups_members_directory_busy=[],um_groups_members_directories=[];function um_get_group_filters_data(n){var p=[];return n.find(".um-search-filter").each(function(){var o,t,a,u,e,r,s,i=jQuery(this);i.find("input.um-datepicker-filter").length?(o="datepicker",i.find("input.um-datepicker-filter").each(function(){var e,r,t,a,u,s;"to"!==jQuery(this).data("range")&&(e=jQuery(this).data("filter_name"),r=um_get_data_for_directory(n,"filter_"+e+"_from"),t=um_get_data_for_directory(n,"filter_"+e+"_to"),void 0!==r||void 0!==t)&&((a=jQuery(this).val())===(u=n.find('input.um-datepicker-filter[data-range="to"][data-filter_name="'+e+'"]').val())?s=u:""!==a&&""!==u?s=a+" - "+u:""===a?s="before "+u:""===u&&(s="since "+a),p.push({name:e,label:jQuery(this).data("filter-label"),value_label:s,value:[r,t],type:o}))})):i.find("input.um-timepicker-filter").length?(o="timepicker",i.find("input.um-timepicker-filter").each(function(){var e,r,t,a,u,s;"to"!==jQuery(this).data("range")&&(e=jQuery(this).data("filter_name"),r=um_get_data_for_directory(n,"filter_"+e+"_from"),t=um_get_data_for_directory(n,"filter_"+e+"_to"),void 0!==r||void 0!==t)&&((a=jQuery(this).val())===(u=n.find('input.um-timepicker-filter[data-range="to"][data-filter_name="'+e+'"]').val())?s=u:""!==a&&""!==u?s=a+" - "+u:""===a?s="before "+u:""===u&&(s="since "+a),p.push({name:e,label:jQuery(this).data("filter-label"),value_label:s,value:[r,t],type:o}))})):i.find("select").length?(o="select",t=i.find("select").attr("name"),a=i.find("select").data("placeholder"),u=void 0===(u=um_get_data_for_directory(n,"filter_"+t))?[]:u.split("||"),jQuery.each(u,function(e){var r=i.find('select option[value="'+u[e]+'"]').data("value_label");p.push({name:t,label:a,value_label:r,value:u[e],type:o})})):i.find("div.ui-slider").length&&(o="slider",t=i.find("div.ui-slider").data("field_name"),e=um_get_data_for_directory(n,"filter_"+t+"_from"),r=um_get_data_for_directory(n,"filter_"+t+"_to"),void 0===e&&void 0===r||(a=i.find("div.um-slider-range").data("label"),s=i.find("div.um-slider-range").data("placeholder").replace("{min_range}",e).replace("{max_range}",r).replace("{field_label}",i.find("div.um-slider-range").data("label")),p.push({name:t,label:a,value_label:s,value:[e,r],type:o})))}),p}function um_group_filters_change_tag(e){var r,t=um_get_group_filters_data(e),a=(e.find(".um-members-filter-tag").remove(),e.find(".um-filtered-line"));a.length&&(r=wp.template("um-members-filtered-line"),a.prepend(r({filters:t})),0===e.find(".um-members-filter-remove").length?(e.find(".um-clear-filters").hide(),e.find(".um-clear-filters").parents(".um-member-directory-header-row").addClass("um-header-row-invisible")):(e.find(".um-clear-filters").show(),e.find(".um-clear-filters").parents(".um-member-directory-header-row").removeClass("um-header-row-invisible")))}function um_group_set_range_label(e,r){var t="",a=e.siblings(".um-slider-range").data("placeholder-s"),u=e.siblings(".um-slider-range").data("placeholder-p"),t=(r?r.values[0]===r.values[1]?a.replace("{value}",r.values[0]):u.replace("{min_range}",r.values[0]).replace("{max_range}",r.values[1]):e.slider("values",0)===e.slider("values",1)?a.replace("{value}",e.slider("values",0)):u.replace("{min_range}",e.slider("values",0)).replace("{max_range}",e.slider("values",1))).replace("{field_label}",e.siblings(".um-slider-range").data("label"));e.siblings(".um-slider-range").html(t),e.siblings(".um_range_min").val(e.slider("values",0)),e.siblings(".um_range_max").val(e.slider("values",1))}function um_get_group_search(e){return e.find(".um-search-line").length?e.find(".um-search-line").val():""}function um_run_group_search(e){var r,t;um_group_is_directory_busy(e)||(um_group_members_show_preloader(e),r=um_get_data_for_group(e,"search"),(t=e.find(".um-search-line").val())===r||""===t&&void 0===r?um_group_members_hide_preloader(e):(e.data("general_search",t),um_group_set_url_from_data(e,"search",t),e.data("page",1).attr("data-page",1),um_group_set_url_from_data(e,"page",""),e.data("searched",1),e.hasClass("um-groups-users-wrapper")?um_ajax_get_group_members(e):e.hasClass("um-groups-requests-wrapper")?um_ajax_get_group_requests(e):e.hasClass("um-groups-invites-users-wrapper")?um_ajax_get_group_invites(e):e.hasClass("um-groups-blocked-wrapper")&&um_ajax_get_group_blocked(e)))}function um_get_data_for_group(e,r){var t=um_group_members_get_hash(e),a={},u=um_parse_current_url();if(jQuery.each(u,function(e){-1!==e.indexOf("_"+t)&&""!==u[e]&&(a[e.replace("_"+t,"")]=u[e])}),r){if(void 0!==a[r])try{a[r]=decodeURI(a[r])}catch(e){console.error(e)}return a[r]}return a}function um_group_set_url_from_data(e,r,t){var a,u=um_group_members_get_hash(e),s=um_get_data_for_group(e),o={},i=(Array.isArray(t)?(jQuery.each(t,function(e){t[e]=encodeURIComponent(t[e])}),t=t.join("||")):jQuery.isNumeric(t)||(t=t.split("||"),jQuery.each(t,function(e){t[e]=encodeURIComponent(t[e])}),t=t.join("||")),""!==t&&(o[r+"_"+u]=t),jQuery.each(s,function(e){r===e?""!==t&&(o[e+"_"+u]=t):o[e+"_"+u]=s[e]}),jQuery.each(um_groups_members_directories,function(e){var r,t=um_groups_members_directories[e];t!==u&&(r=um_get_data_for_group(jQuery('.um-directory[data-hash="'+t+'"]')),jQuery.each(r,function(e){o[e+"_"+t]=r[e]}))}),[]),e=(jQuery.each(o,function(e){i.push(e+"="+o[e])}),i=wp.hooks.applyFilters("um_groups_member_directory_url_attrs",i),e.hasClass("um-groups-users-wrapper")?a="tab=members":e.hasClass("um-groups-requests-wrapper")?a="tab=requests":e.hasClass("um-groups-invites-users-wrapper")?a="tab=invites":e.hasClass("um-groups-blocked-wrapper")&&(a="tab=blocked"),"?"+a);""!==i.join("&")&&(e+="&"+i.join("&")),window.history.pushState("string","UM Groups Member Directory",window.location.origin+window.location.pathname+e)}function um_group_members_get_hash(e){return e.data("hash")}function um_group_is_directory_busy(e){e=um_group_members_get_hash(e);return void 0!==um_groups_members_directory_busy[e]&&um_groups_members_directory_busy[e]}function um_group_members_show_preloader(e){um_groups_members_directory_busy[um_group_members_get_hash(e)]=!0,e.find(".um-members-overlay").show()}function um_group_members_hide_preloader(e){um_groups_members_directory_busy[um_group_members_get_hash(e)]=!1,e.find(".um-members-overlay").hide()}function um_ajax_get_group_members(t){var a=um_group_members_get_hash(t),e=jQuery(t).attr("data-page");wp.ajax.send("um_groups_get_members",{data:{group_id:a,page:e,nonce:um_scripts.nonce},success:function(e){var r;e.users&&(r=wp.template("um_groups_members")({users:e.users,group_id:a}),jQuery(".um-groups-members-list").html(r),t.addClass("um-loaded"),e.pagination)&&(t.attr("total_pages",e.pagination.total_pages),r=wp.template("um-members-pagination")({pagination:e.pagination}),jQuery(".um-members-pagination-box").html(r)),um_group_members_hide_preloader(t),um_init_new_dropdown()},error:function(e){console.log(e)}})}function um_ajax_get_group_requests(t){var a=um_group_members_get_hash(t),e=jQuery(t).attr("data-page");wp.ajax.send("um_groups_get_requests",{data:{group_id:a,page:e,nonce:um_scripts.nonce},success:function(e){var r;e.users&&(r=wp.template("um_groups_members")({users:e.users,group_id:a}),jQuery(".um-groups-members-list").html(r),t.addClass("um-loaded"),e.pagination)&&(t.attr("total_pages",e.pagination.total_pages),r=wp.template("um-members-pagination")({pagination:e.pagination}),jQuery(".um-members-pagination-box").html(r)),um_group_members_hide_preloader(t),um_init_new_dropdown()},error:function(e){console.log(e)}})}function um_ajax_get_group_invites(s){var t=um_group_members_get_hash(s),e=jQuery(s).attr("data-page"),r=um_get_group_search(s),o={group_id:t,page:e,search:r,nonce:um_scripts.nonce};s.find(".um-search-filter").length&&s.find(".um-search-filter").each(function(){var e,r,t,a,u=jQuery(this);u.find(".um-slider").length?(t=u.find(".um-slider").data("field_name"),e=um_get_data_for_group(s,"filter_"+t+"_from"),r=um_get_data_for_group(s,"filter_"+t+"_to"),void 0===e&&void 0===r||(o[t]=[e,r])):u.find(".um-datepicker-filter").length?(t=u.find(".um-datepicker-filter").data("filter_name"),e=um_get_data_for_group(s,"filter_"+t+"_from"),r=um_get_data_for_group(s,"filter_"+t+"_to"),void 0===e&&void 0===r||(o[t]=[e,r])):u.find(".um-timepicker-filter").length?(t=u.find(".um-timepicker-filter").data("filter_name"),e=um_get_data_for_group(s,"filter_"+t+"_from"),r=um_get_data_for_group(s,"filter_"+t+"_to"),void 0===e&&void 0===r||(o[t]=[e,r])):u.find(".um-select-filter-type").length?(t=u.find("select").attr("name"),void 0!==(a=um_get_data_for_group(s,"filter_"+t))&&(o[t]=a.split("||"))):(t=u.find("input").attr("name"),void 0!==(a=um_get_data_for_group(s,"filter_"+t))&&(o[t]=a))}),o=wp.hooks.applyFilters("um_group_invites_filter_request",o),wp.ajax.send("um_groups_get_invites",{data:o,success:function(e){var r;e.users&&(r=wp.template("um_groups_members")({users:e.users,group_id:t}),jQuery(".um-groups-members-list").html(r),s.addClass("um-loaded"),e.pagination)&&(s.attr("total_pages",e.pagination.total_pages),r=wp.template("um-members-pagination")({pagination:e.pagination}),jQuery(".um-members-pagination-box").html(r)),um_group_members_hide_preloader(s)},error:function(e){console.log(e)}})}function um_ajax_get_group_blocked(t){var a=um_group_members_get_hash(t),e=jQuery(t).attr("data-page");wp.ajax.send("um_groups_get_blocked",{data:{group_id:a,page:e,nonce:um_scripts.nonce},success:function(e){var r;e.users&&(r=wp.template("um_groups_members")({users:e.users,group_id:a}),jQuery(".um-groups-members-list").html(r),t.addClass("um-loaded"),e.pagination)&&(t.attr("total_pages",e.pagination.total_pages),r=wp.template("um-members-pagination")({pagination:e.pagination}),jQuery(".um-members-pagination-box").html(r)),um_group_members_hide_preloader(t)},error:function(e){console.log(e)}})}jQuery(document).ready(function(){function s(){var e,r=jQuery("li[class^=um-groups-tab-slug_].active").find(".count");r&&(e=parseInt(r.text())-1,r.text(e),e<=0)&&window.location.reload()}jQuery(document).on("click",".um-groups-btn-join",function(){var r=jQuery(this),e=r.data("group_id"),t=r.parents("div.actions");jQuery.ajax({method:"POST",url:wp.ajax.settings.url,type:"post",data:{action:"um_groups_join_group",group_id:e,nonce:um_scripts.nonce}}).done(function(e){!0===e.status&&(r.addClass("um-groups-btn-leave"),r.removeClass("um-groups-btn-join"),r.text(e.labels.leave),r.addClass("um-groups-btn-join-request"),"public"===e.privacy?(t.find("ul").find("li.count-members").find("span").text(e.members),r.addClass("um-groups-has-joined")):"hidden"===e.privacy&&r.hide(),r.parents(".um-group-single-header").length)&&window.location.reload()}).fail(function(e,r){console.log("join group error",r)})}),jQuery(document).on("click",".um-groups-btn-leave",function(){var t=jQuery(this),e=t.data("group_id"),a=t.parents("div.actions");jQuery.ajax({method:"POST",url:wp.ajax.settings.url,type:"post",data:{action:"um_groups_leave_group",group_id:e,nonce:um_scripts.nonce}}).done(function(e){var r;e.status&&(t.addClass("um-groups-btn-join"),t.removeClass("um-groups-btn-leave"),t.removeClass("um-groups-btn-join-request"),t.text(e.labels.join),t.attr("data-groups-button-hover",e.labels.hover),"public"!==e.privacy&&"private"!==e.privacy||a.find("ul").find("li.count-members").find("span").text(e.members),t.parents(".um-group-single-header").length?window.location.reload():t.parents(".um-groups-directory").length&&"hidden"===e.privacy&&(e=t.parents(".um-groups-directory").siblings("#um-groups-filters").find(".filters .all > a > span"),r=parseInt(e.html()),e.html(r-1),t.parents(".um-group-item").remove()))}).fail(function(e,r){console.log("leave group error",r)})}),jQuery(document).on({mouseenter:function(){var e=jQuery(this),r=e.attr("data-groups-button-hover");r&&e.text(r),e.addClass("um-groups-btn-leave")},mouseleave:function(){var e=jQuery(this),r=e.attr("data-groups-button-default");r&&e.text(r),e.removeClass("um-groups-btn-leave")}},".um-groups-single-button a.um-button:not(.um-groups-btn-join,.um-groups-has-joined)"),jQuery(document).on({mouseenter:function(){var e=jQuery(this);e.removeClass("disabled"),e.html('<span class="um-faicon-paper-plane-o"></span> '+um_scripts.groups_settings.labels.resend)},mouseleave:function(){var e=jQuery(this);e.addClass("disabled"),e.html('<span class="um-faicon-check"></span> '+um_scripts.groups_settings.labels.invited)}},'#um-group-buttons .um-group-button[data-action-key="resend_invite"]:not(.um-groups-has-invited)'),jQuery(document).on({mouseenter:function(){var e=jQuery(this);e.find("td").find("select").show(),e.find("td").find("span.label").hide()},mouseleave:function(){var e=jQuery(this);e.find("td").find("select").hide(),e.find("td").find("span.label").show()}},"table#um_groups_manage_members tbody tr"),jQuery("ul.um-groups-single-tabs li:first a").on("click",function(){window.location.href=jQuery(this).attr("href")}),jQuery(document.body).on("click",".um-groups-confirm-invite",function(){var e=jQuery(this),r=e.attr("data-user_id"),e=e.attr("data-group_id")||jQuery('input[name="group_id"]').val();jQuery.ajax({method:"POST",url:wp.ajax.settings.url,type:"post",data:{action:"um_groups_confirm_invite",group_id:e,user_id:r,self:!0,nonce:um_scripts.nonce}}).done(function(e){window.location.reload()}).fail(function(e,r){console.log(r)})}),jQuery(document.body).on("click",".um-groups-confirm-invite-in-list",function(){var e=jQuery(this),r=e.attr("data-user_id"),e=e.attr("data-group");jQuery.ajax({method:"POST",url:wp.ajax.settings.url,type:"post",data:{action:"um_groups_confirm_invite",group_id:e,user_id:r,self:!0,nonce:um_scripts.nonce}}).done(function(e){window.location.reload()}).fail(function(e,r){console.log(r)})}),jQuery(document.body).on("click",".um-groups-ignore-invite",function(){var e=jQuery(this),r=e.attr("data-user_id"),e=e.attr("data-group_id")||jQuery('input[name="group_id"]').val();jQuery.ajax({method:"POST",url:wp.ajax.settings.url,type:"post",data:{action:"um_groups_ignore_invite",group_id:e,user_id:r,nonce:um_scripts.nonce}}).done(function(e){window.location.reload()}).fail(function(e,r){console.log(r)})}),jQuery(document.body).on("click",".um-groups-ignore-invite-in-list",function(){var e=jQuery(this),r=e.attr("data-user_id"),e=e.attr("data-group");jQuery.ajax({method:"POST",url:wp.ajax.settings.url,type:"post",data:{action:"um_groups_ignore_invite",group_id:e,user_id:r,nonce:um_scripts.nonce}}).done(function(e){window.location.reload()}).fail(function(e,r){console.log(r)})}),jQuery(document).on("click",".um-group-buttons a.um-group-button-more",function(){var e=jQuery(this),r=(jQuery(".um-group-buttons a.um-group-button-more.active").removeClass("active"),e.parent(".um-group-buttons").find("ul[class=um-group-buttons-more]"));return r.is(":visible")?r.hide():(jQuery("ul[class=um-group-buttons-more]").hide(),r.show(),e.addClass("active")),!1}),jQuery(document.body).on("click",".um-group-buttons a[data-action-key]",function(){var r=jQuery(this),t=r.parents(".um-groups-user-wrap"),e=r.data("action-key"),a=t.data("group-id"),u=t.data("group-uid");switch(e){case"invite":r.hasClass("um-groups-has-invited")||wp.ajax.send("um_groups_send_invitation_mail",{data:{group:a,user_id:u,nonce:um_scripts.nonce},success:function(e){r.addClass("disabled"),r.addClass("um-groups-has-invited"),r.html('<span class="um-faicon-check"></span> '+um_scripts.groups_settings.labels.invited)},error:function(e){console.log("send invite error",e)}});break;case"resend_invite":r.hasClass("um-groups-has-invited")||wp.ajax.send("um_groups_send_invitation_mail",{data:{group:a,user_id:u,nonce:um_scripts.nonce},success:function(e){r.addClass("disabled"),r.addClass("um-groups-has-invited"),r.html('<span class="um-faicon-check"></span> '+um_scripts.groups_settings.labels.resent_invite)},error:function(e){console.log("resend invite error",error)}});break;case"unblock":wp.ajax.send("um_groups_unblock_user",{data:{group:a,user_id:u,nonce:um_scripts.nonce},success:function(e){t.fadeOut(),s()},error:function(e){console.log("unblock member error",e)}})}return!1}),jQuery(document.body).on("click",".um-group-buttons .um-new-dropdown li a",function(){var e=jQuery(this),a=jQuery('.um-groups-user-wrap[data-group-id="'+e.data("group-id")+'"][data-group-uid="'+e.data("group-uid")+'"]');if(a.length){var r=e.attr("class"),t=a.data("group-id"),u=a.data("group-uid");switch(r){case"make-admin":case"make-moderator":case"make-member":wp.ajax.send("um_groups_change_member_role",{data:{group:t,user_id:u,role:r.replace("make-",""),nonce:um_scripts.nonce},success:function(r){var t;void 0!==r.dropdown_actions?(t="",jQuery.each(r.dropdown_actions,function(e){t+='<li><a href="javascript:void(0);" class="'+e+'">'+r.dropdown_actions[e].title+"</a></li>"}),a.find(".um-group-buttons").find(".um-member-actions .um-new-dropdown ul").html(t)):a.find(".um-group-buttons").html("")},error:function(e){console.log("change member role error",error,e)}});break;case"remove-from-group":confirm(wp.i18n.__("Are you sure that you want to expel this member?","um-groups"))&&wp.ajax.send("um_groups_delete_member",{data:{group:t,user_id:u,nonce:um_scripts.nonce},success:function(e){a.fadeOut(),s()},error:function(e){console.log(e)}});break;case"remove-self-from-group":confirm(wp.i18n.__("Are you sure that you want to leave this group?","um-groups"))&&wp.ajax.send("um_groups_delete_member",{data:{group:t,user_id:u,nonce:um_scripts.nonce},success:function(e){a.fadeOut(),s(),window.location.reload()},error:function(e){console.log(e)}});break;case"approve":wp.ajax.send("um_groups_approve_user",{data:{group:t,user_id:u,nonce:um_scripts.nonce},success:function(e){a.fadeOut(),s()},error:function(e){console.log("approve member error",e)}});break;case"reject":wp.ajax.send("um_groups_reject_user",{data:{group:t,user_id:u,nonce:um_scripts.nonce},success:function(e){a.fadeOut(),s()},error:function(e){console.log("reject member error",e)}});break;case"block":wp.ajax.send("um_groups_block_user",{data:{group:t,user_id:u,nonce:um_scripts.nonce},success:function(e){a.fadeOut(),s()},error:function(e){console.log("block member error",e)}})}return!1}}),jQuery(document).on("click",".um-groups-lazy-load",function(){var t=jQuery(this),e={action:"um_groups_load_more_groups",settings:t.data("groups-pagi-settings"),nonce:um_scripts.nonce},r=t.parent(".um-groups-list-pagination"),a=parseInt(t.attr("data-groups-page"))+1;return e.settings.page=a,e.settings.user_id=parseInt(t.attr("data-groups-userid")),t.text("..."),jQuery.ajax({method:"POST",url:wp.ajax.settings.url,type:"json",data:e}).done(function(e){0===e.found.total_groups?(t.text(t.data("no-more-groups-text")),r.remove()):(t.text(t.data("load-more-text")),t.attr("data-groups-page",a),r.before(e.html)),a>=e.found.total_pages&&r.remove()}).fail(function(e,r){t.text(um_scripts.groups_settings.labels.went_wrong)}),!1}),jQuery(".um-groups-single .um-member-directory-filters-a").on("click",function(){var e=jQuery(this),r=e.parents(".um-groups-invites-users-wrapper").find(".um-search");r.is(":visible")?r.slideUp(250,function(){e.toggleClass("um-member-directory-filters-visible"),r.parents(".um-member-directory-header-row").toggleClass("um-header-row-invisible")}):r.slideDown({start:function(){jQuery(this).css({display:"grid"}),e.toggleClass("um-member-directory-filters-visible"),r.parents(".um-member-directory-header-row").toggleClass("um-header-row-invisible")}},250)}),jQuery(".um-groups-users-wrapper").length&&jQuery(".um-groups-users-wrapper").each(function(){var e=jQuery(this),r=um_group_members_get_hash(e);um_groups_members_directories.push(r),um_group_members_show_preloader(e),um_ajax_get_group_members(e)}),jQuery(".um-groups-requests-wrapper").length&&jQuery(".um-groups-requests-wrapper").each(function(){var e=jQuery(this),r=um_group_members_get_hash(e);um_groups_members_directories.push(r),um_group_members_show_preloader(e),um_ajax_get_group_requests(e)}),jQuery(".um-groups-invites-users-wrapper").length&&jQuery(".um-groups-invites-users-wrapper").each(function(){var n=jQuery(this),e=um_group_members_get_hash(n);um_groups_members_directories.push(e),um_group_members_show_preloader(n),um_ajax_get_group_invites(n),n.find(".um-slider").each(function(){var e=jQuery(this),t=e.data("field_name"),r=um_get_data_for_group(n,"filter_"+t+"_from"),a=um_get_data_for_group(n,"filter_"+t+"_to"),r=[r=void 0===r?parseInt(e.data("min")):r,a=void 0===a?parseInt(e.data("max")):a];e.slider({range:!0,min:parseInt(e.data("min")),max:parseInt(e.data("max")),values:r,create:function(e,r){},step:1,slide:function(e,r){um_group_set_range_label(jQuery(this),r)},stop:function(e,r){um_group_is_directory_busy(n)||(um_group_set_url_from_data(n,"filter_"+t+"_from",r.values[0]),um_group_set_url_from_data(n,"filter_"+t+"_to",r.values[1]),n.data("page",1).attr("data-page",1),um_group_set_url_from_data(n,"page",""),um_ajax_get_group_invites(n),um_group_filters_change_tag(n),n.data("searched",1))}}),um_group_set_range_label(e)}),n.find(".um-datepicker-filter").each(function(){var s=jQuery(this),o=new Date(1e3*s.data("date_min")),i=new Date(1e3*s.data("date_max")),e=s.pickadate({selectYears:!0,min:o,max:i,formatSubmit:"yyyy/mm/dd",hiddenName:!0,onOpen:function(){s.blur()},onClose:function(){s.blur()},onSet:function(e){var r,t,a,u;um_group_is_directory_busy(n)||(um_group_members_show_preloader(n),r=s.data("filter_name"),t=s.data("range"),a=um_get_data_for_group(n,"filter_"+r+"_from"),u=um_get_data_for_group(n,"filter_"+r+"_to"),void 0===a&&(a=o/1e3),void 0===u&&(u=i/1e3),e=e.select/1e3,s.val(),"from"===t?a=e:"to"===t&&(u=e),um_group_set_url_from_data(n,"filter_"+r+"_from",a),um_group_set_url_from_data(n,"filter_"+r+"_to",u),n.data("page",1).attr("data-page",1),um_group_set_url_from_data(n,"page",""),um_ajax_get_group_invites(n),um_group_filters_change_tag(n),n.data("searched",1))}}).pickadate("picker"),r=s.data("filter_name"),t=s.data("range"),r=um_get_data_for_group(n,"filter_"+r+"_"+t);void 0!==r&&e.set("select",1e3*r)}),n.find(".um-timepicker-filter").each(function(){var s=jQuery(this),o=s.data("min"),i=s.data("max"),e=o.split(":"),r=i.split(":"),e=s.pickatime({format:s.data("format"),interval:parseInt(s.data("intervals")),min:[e[0],e[1]],max:[r[0],r[1]],formatSubmit:"HH:i",hiddenName:!0,onOpen:function(){s.blur()},onClose:function(){s.blur()},onSet:function(e){var r,t,a,u;um_group_is_directory_busy(n)||(um_group_members_show_preloader(n),r=s.data("filter_name"),t=s.data("range"),a=um_get_data_for_group(n,"filter_"+r+"_from"),u=um_get_data_for_group(n,"filter_"+r+"_to"),void 0===a&&(a=o),void 0===u&&(u=i),void 0!==e.select?(e=e.select/60,s.val(),"from"===t?a=e+":00":"to"===t&&(u=e+":00")):"from"===t?a=o:"to"===t&&(u=i),um_group_set_url_from_data(n,"filter_"+r+"_from",a),um_group_set_url_from_data(n,"filter_"+r+"_to",u),n.data("page",1).attr("data-page",1),um_group_set_url_from_data(n,"page",""),um_ajax_get_group_invites(n),um_group_filters_change_tag(n),n.data("searched",1))}}).pickatime("picker"),r=s.data("filter_name"),t=s.data("range"),r=um_get_data_for_group(n,"filter_"+r+"_"+t);void 0!==r&&(t=r.split(":"),e.set("select",60*t[0]))}),um_group_filters_change_tag(n)}),jQuery(".um-groups-blocked-wrapper").length&&jQuery(".um-groups-blocked-wrapper").each(function(){var e=jQuery(this),r=um_group_members_get_hash(e);um_groups_members_directories.push(r),um_group_members_show_preloader(e),um_ajax_get_group_blocked(e)}),window.addEventListener("popstate",function(e){jQuery(".um-groups-users-wrapper").length&&jQuery(".um-groups-users-wrapper").each(function(){var e=jQuery(this),r=um_group_members_get_hash(e);um_groups_members_directories.push(r),um_group_members_show_preloader(e),um_ajax_get_group_members(e)}),jQuery(".um-groups-requests-wrapper").length&&jQuery(".um-groups-requests-wrapper").each(function(){var e=jQuery(this),r=um_group_members_get_hash(e);um_groups_members_directories.push(r),um_group_members_show_preloader(e),um_ajax_get_group_requests(e)}),jQuery(".um-groups-blocked-wrapper").length&&jQuery(".um-groups-blocked-wrapper").each(function(){var e=jQuery(this),r=um_group_members_get_hash(e);um_groups_members_directories.push(r),um_group_members_show_preloader(e),um_ajax_get_group_blocked(e)}),jQuery(".um-groups-invites-users-wrapper").length&&jQuery(".um-groups-invites-users-wrapper").each(function(){var a=jQuery(this),e=um_group_members_get_hash(a),e=(um_groups_members_directories.push(e),um_group_members_show_preloader(a),a.find(".um-groups-members-list, .um-members-pagination-box").html(""),a.find(".um-member-directory-search-line").length&&(e=um_get_data_for_group(a,"search"),a.data("general_search",e=void 0===e?"":e),a.find(".um-search-line").val(e)),um_get_data_for_group(a,"page"));void 0===e?e=1:e>a.data("total_pages")&&(e=a.data("total_pages")),a.data("page",e).attr("data-page",e),um_ajax_get_group_invites(a),a.find(".um-datepicker-filter").each(function(){var e=jQuery(this),r=e.pickadate("picker"),t=e.data("filter_name"),e=e.data("range"),t=um_get_data_for_group(a,"filter_"+t+"_"+e);void 0!==t?r.set("select",1e3*t):r.clear()}),a.find(".um-slider").each(function(){var e=jQuery(this),r=e.data("field_name"),t=um_get_data_for_group(a,"filter_"+r+"_from"),r=um_get_data_for_group(a,"filter_"+r+"_to");void 0===t&&(t=e.data("min")),t=parseInt(t),void 0===r&&(r=e.data("max")),r=parseInt(r),e.slider("values",[t,r]),um_group_set_range_label(e)}),a.find(".um-timepicker-filter").each(function(){var e=jQuery(this),r=e.pickatime("picker"),t=e.data("filter_name"),e=e.data("range"),t=um_get_data_for_group(a,"filter_"+t+"_"+e);void 0!==t?(e=t.split(":"),r.set("select",60*e[0])):r.clear()}),um_group_filters_change_tag(a)})}),jQuery(document.body).on("click",".um-group-tab-content-wrap .pagi:not(.current), .um-groups-members-list ~ .um-members-pagination-box .pagi:not(.current)",function(){var e,r;jQuery(this).hasClass("disabled")||(jQuery(this).parents(".um-groups-users-wrapper").length?e=jQuery(this).parents(".um-groups-users-wrapper"):jQuery(this).parents(".um-groups-requests-wrapper").length?e=jQuery(this).parents(".um-groups-requests-wrapper"):jQuery(this).parents(".um-groups-invites-users-wrapper").length?e=jQuery(this).parents(".um-groups-invites-users-wrapper"):jQuery(this).parents(".um-groups-blocked-wrapper").length&&(e=jQuery(this).parents(".um-groups-blocked-wrapper")),um_group_is_directory_busy(e))||(um_group_members_show_preloader(e),(1===(r="first"===jQuery(this).data("page")?1:"prev"===jQuery(this).data("page")?+e.data("page")-1:"next"===jQuery(this).data("page")?+e.data("page")+1:"last"===jQuery(this).data("page")?parseInt(e.attr("total_pages")):parseInt(jQuery(this).data("page")))?(e.find('.pagi[data-page="first"], .pagi[data-page="prev"]').addClass("disabled"),e.find('.pagi[data-page="prev"], .pagi[data-page="last"]')):(r===parseInt(e.attr("total_pages"))?e.find('.pagi[data-page="prev"], .pagi[data-page="last"]').addClass("disabled"):e.find('.pagi[data-page="prev"], .pagi[data-page="last"]').removeClass("disabled"),e.find('.pagi[data-page="first"], .pagi[data-page="prev"]'))).removeClass("disabled"),e.find(".pagi").removeClass("current"),e.find('.pagi[data-page="'+r+'"]').addClass("current"),e.data("page",r).attr("data-page",r),um_group_set_url_from_data(e,"page",1===r?"":r),jQuery(this).parents(".um-groups-users-wrapper").length?um_ajax_get_group_members(e):jQuery(this).parents(".um-groups-requests-wrapper").length?um_ajax_get_group_requests(e):jQuery(this).parents(".um-groups-invites-users-wrapper").length?um_ajax_get_group_invites(e):jQuery(this).parents(".um-groups-blocked-wrapper").length&&um_ajax_get_group_blocked(e))}),jQuery(document.body).on("change",".um-group-tab-content-wrap .um-members-pagi-dropdown, .um-groups-members-list ~ .um-members-pagination-box .um-members-pagi-dropdown",function(){var e,r;jQuery(this).parents(".um-groups-users-wrapper").length?e=jQuery(this).parents(".um-groups-users-wrapper"):jQuery(this).parents(".um-groups-requests-wrapper").length?e=jQuery(this).parents(".um-groups-requests-wrapper"):jQuery(this).parents(".um-groups-invites-users-wrapper").length?e=jQuery(this).parents(".um-groups-invites-users-wrapper"):jQuery(this).parents(".um-groups-blocked-wrapper").length&&(e=jQuery(this).parents(".um-groups-blocked-wrapper")),um_group_is_directory_busy(e)||(um_group_members_show_preloader(e),r=jQuery(this).val(),e.find(".pagi").removeClass("current"),e.find('.pagi[data-page="'+r+'"]').addClass("current"),e.data("page",r).attr("data-page",r),um_group_set_url_from_data(e,"page",1===r?"":r),jQuery(this).parents(".um-groups-users-wrapper").length?um_ajax_get_group_members(e):jQuery(this).parents(".um-groups-requests-wrapper").length?um_ajax_get_group_requests(e):jQuery(this).parents(".um-groups-invites-users-wrapper").length?um_ajax_get_group_invites(e):jQuery(this).parents(".um-groups-blocked-wrapper").length&&um_ajax_get_group_blocked(e))}),jQuery(document.body).on("click",".um-group-tab-content-wrap .um-do-search",function(){var e;jQuery(this).parents(".um-groups-users-wrapper").length?e=jQuery(this).parents(".um-groups-users-wrapper"):jQuery(this).parents(".um-groups-requests-wrapper").length?e=jQuery(this).parents(".um-groups-requests-wrapper"):jQuery(this).parents(".um-groups-invites-users-wrapper").length?e=jQuery(this).parents(".um-groups-invites-users-wrapper"):jQuery(this).parents(".um-groups-blocked-wrapper").length&&(e=jQuery(this).parents(".um-groups-blocked-wrapper")),um_run_group_search(e)}),jQuery(document.body).on("keypress",".um-group-tab-content-wrap .um-search-line",function(e){var r;13===e.which&&(jQuery(this).parents(".um-groups-users-wrapper").length?r=jQuery(this).parents(".um-groups-users-wrapper"):jQuery(this).parents(".um-groups-requests-wrapper").length?r=jQuery(this).parents(".um-groups-requests-wrapper"):jQuery(this).parents(".um-groups-invites-users-wrapper").length?r=jQuery(this).parents(".um-groups-invites-users-wrapper"):jQuery(this).parents(".um-groups-blocked-wrapper").length&&(r=jQuery(this).parents(".um-groups-blocked-wrapper")),um_run_group_search(r))}),jQuery(".um-group-tab-content-wrap .um-member-directory-filters-a").on("click",function(){var e=jQuery(this),r=e.parents(".um-directory").find(".um-search");r.is(":visible")?r.slideUp(250,function(){e.toggleClass("um-member-directory-filters-visible"),r.parents(".um-member-directory-header-row").toggleClass("um-header-row-invisible")}):r.slideDown({start:function(){jQuery(this).css({display:"grid"}),e.toggleClass("um-member-directory-filters-visible"),r.parents(".um-member-directory-header-row").toggleClass("um-header-row-invisible")}},250)}),jQuery(document.body).on("keypress",".um-group-tab-content-wrap .um-text-filter-type input",function(e){var r;13===e.which&&(jQuery(this).parents(".um-groups-users-wrapper").length?r=jQuery(this).parents(".um-groups-users-wrapper"):jQuery(this).parents(".um-groups-requests-wrapper").length?r=jQuery(this).parents(".um-groups-requests-wrapper"):jQuery(this).parents(".um-groups-invites-users-wrapper").length?r=jQuery(this).parents(".um-groups-invites-users-wrapper"):jQuery(this).parents(".um-groups-blocked-wrapper").length&&(r=jQuery(this).parents(".um-groups-blocked-wrapper")),um_group_is_directory_busy(r)||(um_group_members_show_preloader(r),um_group_set_url_from_data(r,"filter_"+jQuery(this).prop("name"),jQuery(this).val()),r.data("page",1).attr("data-page",1),um_group_set_url_from_data(r,"page",""),um_ajax_get_group_invites(r),um_group_filters_change_tag(r),r.data("searched",1)))}),jQuery(document.body).on("change",".um-group-tab-content-wrap .um-search-filter select",function(){var e,r,t;""===jQuery(this).val()||(jQuery(this).parents(".um-groups-users-wrapper").length?e=jQuery(this).parents(".um-groups-users-wrapper"):jQuery(this).parents(".um-groups-requests-wrapper").length?e=jQuery(this).parents(".um-groups-requests-wrapper"):jQuery(this).parents(".um-groups-invites-users-wrapper").length?e=jQuery(this).parents(".um-groups-invites-users-wrapper"):jQuery(this).parents(".um-groups-blocked-wrapper").length&&(e=jQuery(this).parents(".um-groups-blocked-wrapper")),um_group_is_directory_busy(e))||(um_group_members_show_preloader(e),t=void 0===(t=um_get_data_for_group(e,"filter_"+(r=jQuery(this).prop("name"))))?[]:t.split("||"),-1===jQuery.inArray(jQuery(this).val(),t)&&(t.push(jQuery(this).val()),um_group_set_url_from_data(e,"filter_"+r,t=t.join("||")),e.data("page",1).attr("data-page",1),um_group_set_url_from_data(e,"page","")),jQuery(this).find('option[value="'+jQuery(this).val()+'"]').prop("disabled",!0).hide(),1===jQuery(this).find("option:not(:disabled)").length&&jQuery(this).prop("disabled",!0),jQuery(this).select2("destroy").select2(),jQuery(this).val("").trigger("change"),um_ajax_get_group_invites(e),um_group_filters_change_tag(e),e.data("searched",1))}),jQuery(document.body).on("click",".um-group-tab-content-wrap .um-members-filter-remove",function(){var e,r,t,a,u;jQuery(this).parents(".um-groups-users-wrapper").length?e=jQuery(this).parents(".um-groups-users-wrapper"):jQuery(this).parents(".um-groups-requests-wrapper").length?e=jQuery(this).parents(".um-groups-requests-wrapper"):jQuery(this).parents(".um-groups-invites-users-wrapper").length?e=jQuery(this).parents(".um-groups-invites-users-wrapper"):jQuery(this).parents(".um-groups-blocked-wrapper").length&&(e=jQuery(this).parents(".um-groups-blocked-wrapper")),!um_group_is_directory_busy(e)&&e&&(um_group_members_show_preloader(e),r=jQuery(this).data("value"),t=jQuery(this).data("name"),"select"===(a=jQuery(this).data("type"))?(u=void 0===(u=um_get_data_for_group(e,"filter_"+t))?[]:u.split("||"),um_group_set_url_from_data(e,"filter_"+t,u=(u=-1!==jQuery.inArray(r.toString(),u)?jQuery.grep(u,function(e){return e!==r.toString()}):u).length?u:""),(u=jQuery('.um-search-filter select[name="'+t+'"]')).find('option[value="'+r+'"]').prop("disabled",!1).show(),1<u.find("option:not(:disabled)").length&&u.prop("disabled",!1),u.select2("destroy").select2()):"slider"!==a&&"datepicker"!==a&&"timepicker"!==a||(um_group_set_url_from_data(e,"filter_"+t+"_from",""),um_group_set_url_from_data(e,"filter_"+t+"_to","")),e.data("page",1).attr("data-page",1),um_group_set_url_from_data(e,"page",""),jQuery(this).tipsy("hide"),jQuery(this).parents(".um-members-filter-tag").remove(),0===e.find(".um-members-filter-remove").length?e.find(".um-clear-filters").hide():e.find(".um-clear-filters").show(),um_ajax_get_group_invites(e))}),jQuery(document.body).on("click",".um-group-tab-content-wrap .um-clear-filters-a",function(){var u;if(jQuery(this).parents(".um-groups-users-wrapper").length?u=jQuery(this).parents(".um-groups-users-wrapper"):jQuery(this).parents(".um-groups-requests-wrapper").length?u=jQuery(this).parents(".um-groups-requests-wrapper"):jQuery(this).parents(".um-groups-invites-users-wrapper").length?u=jQuery(this).parents(".um-groups-invites-users-wrapper"):jQuery(this).parents(".um-groups-blocked-wrapper").length&&(u=jQuery(this).parents(".um-groups-blocked-wrapper")),!um_group_is_directory_busy(u)){um_group_members_show_preloader(u),u.find(".um-members-filter-remove").each(function(){var e,r=jQuery(this).data("value"),t=jQuery(this).data("name"),a=jQuery(this).data("type");"select"===a?(e=void 0===(e=um_get_data_for_directory(u,"filter_"+t))?[]:e.split("||"),(e=-1!==jQuery.inArray(r.toString(),e)?jQuery.grep(e,function(e){return e!==r.toString()}):e).length||(e=""),um_group_set_url_from_data(u,"filter_"+t,e),(e=jQuery('.um-search-filter select[name="'+t+'"]')).find('option[value="'+r+'"]').prop("disabled",!1).show(),1<e.find("option:not(:disabled)").length&&e.prop("disabled",!1),e.select2("destroy").select2()):"slider"!==a&&"datepicker"!==a&&"timepicker"!==a||(um_group_set_url_from_data(u,"filter_"+t+"_from",""),um_group_set_url_from_data(u,"filter_"+t+"_to",""))}),u.data("page",1).attr("data-page",1),um_group_set_url_from_data(u,"page",""),u.find(".um-members-filter-tag").remove(),0===u.find(".um-members-filter-remove").length?(u.find(".um-clear-filters").hide(),u.find(".um-clear-filters").parents(".um-member-directory-header-row").addClass("um-header-row-invisible")):(u.find(".um-clear-filters").show(),u.find(".um-clear-filters").parents(".um-member-directory-header-row").removeClass("um-header-row-invisible"));var e=u.data("must-search");if(1===e)if(!um_get_search(u))return u.data("searched",0),u.find(".um-members-grid, .um-members-list").remove(),u.find(".um-member-directory-sorting-options").prop("disabled",!0),u.find(".um-member-directory-view-type").addClass("um-disabled"),void um_group_members_hide_preloader(u);u.find(".um-member-directory-sorting-options").prop("disabled",!1),u.find(".um-member-directory-view-type").removeClass("um-disabled"),um_ajax_get_group_invites(u)}})});